(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[947],{3764:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>h});var n=l(5155),r=l(9841),s=l(2560),i=l(4797),a=l(1130),o=l(2115),c=l(483),d=l(381),x=l(9917),u=l(1925);function h(){var e;let{registerSchema:t}=(0,s.cG)(),l=(0,s.K2)("clienti"),[h,m]=(0,o.useState)(""),[v,g]=(0,o.useState)(!1),[f,p]=(0,o.useState)(null),[b,j]=(0,o.useState)(!1),[N,C]=(0,o.useState)([]),[y,w]=(0,o.useState)(!0),[k,E]=(0,o.useState)(null),[S,z]=(0,o.useState)(""),[A,B]=(0,o.useState)(""),F=()=>{w(!0),(0,u.L2)().then(e=>{C(e),E(null),w(!1)}).catch(()=>{C([]),E("Errore di rete o di backend"),w(!1)})};(0,o.useEffect)(()=>{F()},[]),(0,o.useEffect)(()=>{(0,i.ZY)(t)},[t]);let L=N.filter(e=>{let t=e.RagioneSocialeC&&e.RagioneSocialeC.toLowerCase().includes(h.toLowerCase())||e.IdCliente&&e.IdCliente.toLowerCase().includes(h.toLowerCase()),l=!S||"attivo"===S&&!0===e.AttivoC||"non_attivo"===S&&!1===e.AttivoC,n=!A||e.EffettivoPotenziale===A;return t&&l&&n}),P=l.sortData(L),R=l.getVisibleColumnsWithConfig(),_=(0,o.useCallback)(e=>{l.handleSort(e)},[l]),I=e=>{p(e),g(!0)},T=async e=>{try{if(f){if(!f.IdCliente)return void alert("Errore: ID cliente mancante!");await (0,u.re)(f.IdCliente,e),alert('Cliente "'.concat(e.RagioneSocialeC,'" modificato con successo!'))}else await (0,u.SW)(e),alert('Cliente "'.concat(e.RagioneSocialeC,'" creato con successo!'));g(!1),p(null),F()}catch(e){alert("Errore durante il salvataggio")}},M=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-4 py-2 bg-neutral-700 hover:bg-neutral-600 text-neutral-200 rounded-lg text-sm font-medium transition-colors",children:[(0,n.jsx)(d.A,{className:"w-4 h-4"}),"Configura Tabella"]}),(0,n.jsxs)("button",{onClick:()=>{p(null),g(!0)},className:"bg-[#3B82F6] hover:bg-[#3B82F6]/80 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,n.jsx)("span",{children:"Nuovo Cliente"})]})]}),O=N.filter(e=>!0===e.AttivoC).length,D=N.filter(e=>"Effettivo"===e.EffettivoPotenziale).length,W=N.filter(e=>"Potenziale"===e.EffettivoPotenziale).length;return k?(0,n.jsx)(a.A,{pageTitle:"Gestione Clienti",pageDescription:"Anagrafica e gestione clienti aziendali",headerActions:M,children:(0,n.jsxs)("div",{className:"text-center py-10 text-red-400",children:["Errore: ",k]})}):(0,n.jsxs)(a.A,{pageTitle:"Gestione Clienti",pageDescription:"Anagrafica e gestione clienti aziendali",headerActions:M,children:[(0,n.jsxs)("div",{className:"mb-6 flex items-center space-x-4",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("svg",{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,n.jsx)("input",{type:"text",placeholder:"Cerca per ragione sociale, codice cliente, referente...",value:h,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-neutral-700/60 border border-neutral-600/60 rounded-lg text-neutral-100 placeholder-neutral-400 focus:outline-none focus:border-[#3B82F6] transition-colors"})]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("select",{value:S,onChange:e=>z(e.target.value),className:"px-3 py-2 bg-neutral-700/60 border border-neutral-600/60 rounded-lg text-neutral-100 text-sm focus:outline-none focus:border-[#3B82F6] transition-colors",children:[(0,n.jsx)("option",{value:"",children:"Tutti i clienti"}),(0,n.jsx)("option",{value:"attivo",children:"Solo attivi"}),(0,n.jsx)("option",{value:"non_attivo",children:"Solo non attivi"})]}),(0,n.jsxs)("select",{value:A,onChange:e=>B(e.target.value),className:"px-3 py-2 bg-neutral-700/60 border border-neutral-600/60 rounded-lg text-neutral-100 text-sm focus:outline-none focus:border-[#3B82F6] transition-colors",children:[(0,n.jsx)("option",{value:"",children:"Tutte le categorie"}),(0,n.jsx)("option",{value:"Effettivo",children:"Effettivo"}),(0,n.jsx)("option",{value:"Potenziale",children:"Potenziale"}),(0,n.jsx)("option",{value:"Ex cliente",children:"Ex cliente"})]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"bg-neutral-700/60 border border-neutral-600/60 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-light text-neutral-100",children:N.length}),(0,n.jsx)("div",{className:"text-sm text-neutral-400",children:"Totale Clienti"})]}),(0,n.jsxs)("div",{className:"bg-neutral-700/60 border border-neutral-600/60 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-light text-green-400",children:O}),(0,n.jsx)("div",{className:"text-sm text-neutral-400",children:"Clienti Attivi"})]}),(0,n.jsxs)("div",{className:"bg-neutral-700/60 border border-neutral-600/60 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-light text-[#3B82F6]",children:D}),(0,n.jsx)("div",{className:"text-sm text-neutral-400",children:"Effettivi"})]}),(0,n.jsxs)("div",{className:"bg-neutral-700/60 border border-neutral-600/60 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-light text-amber-400",children:W}),(0,n.jsx)("div",{className:"text-sm text-neutral-400",children:"Potenziali"})]})]}),y?(0,n.jsx)("div",{className:"text-center py-10 text-neutral-400",children:"Caricamento clienti..."}):(0,n.jsx)("div",{className:"bg-neutral-700/40 border border-neutral-600/40 rounded-lg overflow-hidden",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-neutral-700/60 border-b border-neutral-600/60",children:(0,n.jsxs)("tr",{children:[R.map(e=>{var t,r;return(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-300 uppercase tracking-wider cursor-pointer hover:bg-neutral-600/40 transition-colors select-none",style:{width:e.width},onClick:()=>e.sortable&&_(e.key),children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:e.label}),e.sortable&&(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("svg",{className:"w-3 h-3 ".concat((null==(t=l.sortConfig)?void 0:t.key)===e.key&&"asc"===l.sortConfig.direction?"text-[#3B82F6]":"text-neutral-500"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),(0,n.jsx)("svg",{className:"w-3 h-3 -mt-1 ".concat((null==(r=l.sortConfig)?void 0:r.key)===e.key&&"desc"===l.sortConfig.direction?"text-[#3B82F6]":"text-neutral-500"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})},e.key)}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-neutral-300 uppercase tracking-wider w-20",children:"Azioni"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-neutral-600/40",children:P.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-neutral-700/30 transition-colors",children:[R.map(t=>(0,n.jsx)("td",{className:"px-4 py-3 text-sm",style:{width:t.width},children:t.format?t.format(e[t.key],e):e[t.key]},t.key)),(0,n.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)("button",{onClick:()=>I(e),className:"text-neutral-400 hover:text-[#3B82F6] transition-colors",title:"Modifica cliente",children:(0,n.jsx)(x.A,{className:"w-4 h-4"})})})})]},e.IdCliente))})]})})}),(0,n.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"text-sm text-neutral-400",children:["Visualizzati ",P.length," di ",N.length," clienti",l.isClient&&l.sortConfig&&(0,n.jsxs)("span",{className:"ml-2 text-[#3B82F6]",children:["â€¢ Ordinato per"," ",null==(e=R.find(e=>e.key===l.sortConfig.key))?void 0:e.label," ","(","asc"===l.sortConfig.direction?"crescente":"decrescente",")"]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{className:"px-3 py-1 bg-neutral-700/60 border border-neutral-600/60 rounded text-sm text-neutral-300 hover:bg-neutral-700 transition-colors",children:"Precedente"}),(0,n.jsx)("button",{className:"px-3 py-1 bg-[#3B82F6] text-white rounded text-sm",children:"1"}),(0,n.jsx)("button",{className:"px-3 py-1 bg-neutral-700/60 border border-neutral-600/60 rounded text-sm text-neutral-300 hover:bg-neutral-700 transition-colors",children:"2"}),(0,n.jsx)("button",{className:"px-3 py-1 bg-neutral-700/60 border border-neutral-600/60 rounded text-sm text-neutral-300 hover:bg-neutral-700 transition-colors",children:"Successivo"})]})]}),(0,n.jsx)(c.A,{isOpen:v,onClose:()=>{g(!1),p(null)},onSave:T,clienteEdit:f}),(0,n.jsx)(r.A,{isOpen:b,onClose:()=>j(!1),tableId:"clienti",title:"Clienti"})]})}},7806:(e,t,l)=>{Promise.resolve().then(l.bind(l,3764))}},e=>{var t=t=>e(e.s=t);e.O(0,[261,483,264,441,684,358],()=>t(7806)),_N_E=e.O()}]);